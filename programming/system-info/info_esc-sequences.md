# Керуючі символи та Escape-послідовності

Одним із варіантів введення послідовностей у конкретний канал є команда [PRINT](../../manuals/is-basic-man-en/commands/man_cs-print.md) Бейсіка:  
```
PRINT #ch:CHR$(27);"o";
```
наприклад, цей рядок приховає курсор на конкретній відеосторінці, а:
```
PRINT #102:CHR$(27);"M1";
```
змінить колір курсору на зелений.

Escape-послідовності можна зберігати у файл і звідти їх зчитувати.

Наприклад esc-послідовність для зміни символів можна зберегти у файл за допомогою наступної програми на Бейсіку:
```
5 OPEN #1:"ESCFONT.BIN" ACCESS OUTPUT

10 SET #1:CHARACTER 32,2,63,63,1,6,0,0,1,102
20 SET #1:CHARACTER 33,2,63,63,120,120,0,0,1,102

100 CLOSE #1
```

А потім завантажити у потрібний канал:
```
100 OPEN #1:"ESCFONT.BIN" ACCESS INPUT
110 COPY FROM #1 TO #102
120 CLOSE #1
```

## Для усіх відеосторінок

| Символ | HEX | DEC | Опис                                                                                                                                                             |
|:------:|:---:|:---:| ---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|  `^Z`  | 1Ah | 26  | Очистити екран та встановити курсор/промінь на початкову позицію.                                                                                                |
|  `^J`  | 0Ah | 10  | Line-feed. Перемістити курсор донизу на наступний рядок (якщо курсор внизу текстового екрану то здійснюється прокрутка екрану за умови що прокручування активне) |
|  `^M`  | 0Dh | 13  | Carriage return. Повертає курсор на початок поточного рядка.                                                                                                     |
|  `^^`  | 1Eh | 30  | Встановити курсор/промінь на початкову позицію (ASCII RS).                                                                                                                                                                 |

| Символ  |   HEX    |  DEC   | Опис                            | Опис                                |
|:-------:|:--------:|:------:| ------------------------------- | ----------------------------------- |
| `esc K` | 1Bh, 4Bh | 27, 75 | Змінити вигляд символу          | [детальніше](esc-seq/1b4b-video.md) |
| `esc С` | 1Bh, 43h | 27, 67 | Встановити усі кольори палітри  | [детальніше](esc-seq/1b43-video.md) |
| `esc с` | 1Bh, 63h | 27, 99 | Змінити колір палітри           | [детальніше](esc-seq/1b63-video.md) |
| `esc I` | 1Bh, 49h | 27, 73 | Вибрати колір "чорнила"         | [детальніше](esc-seq/1b49-video.md) |
| `esc P` | 1Bh, 50h | 27, 80 | Вибрати колір "паперу"          | [детальніше](esc-seq/1b50-video.md) |
| `esc =` | 1Bh, 3Dh | 27, 61 | Встановити курсор на координати | [детальніше](esc-seq/1b3d-video.md) |

## Для текстових відеосторінок

| Символ | HEX | DEC | Опис                                       |
|:------:|:---:|:---:| ------------------------------------------ |
|  `^Y`  | 19h | 25  | Очистити рядок від курсора до кінця рядка. |
|  `^H`  | 08h |  8  | Перемістити курсор вліво (ASCII BS).       |
|  `^I`  | 09h |  9  | Перемістити курсор вправо (ASCII TAB).     |
|  `^K`  | 0Bh | 11  | Перемістити курсор догори (ASCII VT).      |
|  `^V`  | 16h | 22  | Перемістити курсор униз (ASCII SYN).       |

| Символ  |   HEX    |   DEC   | Опис                                        | Опис                                     |
|:-------:|:--------:|:-------:| ------------------------------------------- | ---------------------------------------- |
| `esc ?` | 1Bh, 3Fh | 27, 63  | Отримати поточні координати курсора         | [детальніше](esc-seq/1b3f-video-text.md) |
| `esc .` | 1Bh, 2Eh | 27, 46  | Змінити символ курсора на інший код символа | [детальніше](esc-seq/1b2e-video-text.md) |
| `esc M` | 1Bh, 4Dh | 27, 77  | Змінити колір курсора                       | [детальніше](esc-seq/1b4d-video-text.md) |
| `esc O` | 1Bh, 4Fh | 27, 79  | Відобразити курсор                          | [детальніше](esc-seq/1b4f-video-text.md) |
| `esc o` | 1Bh, 6Fh | 27, 111 | Приховати курсор                            | [детальніше](esc-seq/1b6f-video-text.md) |
| `esc S` | 1Bh, 53h | 27, 83  | Дозволити автоматичну прокрутку екрану      | [детальніше](esc-seq/1b53-video-text.md) |
| `esc s` | 1Bh, 73h | 27, 115 | Заборонити автоматичну прокрутку екрану     | [детальніше](esc-seq/1b73-video-text.md) |
| `esc U` | 1Bh, 55h | 27, 85  | Прокрутити екран догори                     | [детальніше](esc-seq/1b55-video-text.md) |
| `esc D` | 1Bh, 44h | 27, 68  | Прокрутити екран донизу                     | [детальніше](esc-seq/1b44-video-text.md) |

## Для каналу EDITOR

|      Символ      | HEX | DEC | Опис                                             |
|:----------------:|:---:|:---:| ------------------------------------------------ |
|                  | 00h |  0  | Writes a null to video to check it is still Ok.  |
|       `^I`       | 09h |  9  | Move to, or insert spaces to, next tab stop.     |
|       `^J`       | 0Ah | 10  | Ignored.                                         |
|       `^M`       | 0Dh | 13  | Goes to start of new line (equivalent to CR-LF). |
|       `^X`       | 18h | 24  | Set left margin at cursor column.                |
|       `^Y`       | 19h | 25  | Clear to end of line.                            |
|       `^Z`       | 1Ah | 26  | Clear whole buffer and screen and home cursor.   |
|     `Delete`     | A0h | 160 | Delete character right.                          |
| `Shift`+`Delete` | A1h | 161 | Delete line right.                               |
| `Ctrl`+`Delete`  | A2h | 162 | Delete word right.                               |
|     `Erase`      | A4h | 164 | Erase character left.                            |
| `Shift`+`Erase`  | A5h | 165 | Erase line left.                                 |
|  `Ctrl`+`Erase`  | A6h | 166 | Erase word left.                                 |
|      `Ins`       | A8h | 168 | Insert a space.                                  |
|  `Shift`+`Ins`   | A9h | 169 | Insert a new line.                               |
|   `Ctrl`+`Ins`   | AAh | 170 | Toggle insert/overwrite mode.                    |
|       `UP`       | B0h | 176 | Cursor up line.                                  |
|   `Shift`+`UP`   | B1h | 177 | Cursor up page.                                  |
|   `Ctrl`+`UP`    | B2h | 178 | Cursor up paragraph.                             |
|      `DOWN`      | B4h | 180 | Cursor down line.                                |
|  `Shift`+`DOWN`  | B5h | 181 | Cursor down page.                                |
|  `Ctrl`+`DOWN`   | B6h | 182 | Cursor down paragraph.                           |
|      `LEFT`      | B8h | 184 | Cursor left character.                           |
|  `Shift`+`LEFT`  | B9h | 185 | Cursor to start of line.                         |
|  `Ctrl`+`LEFT`   | BAh | 186 | Cursor left word.                                |
|     `RIGHT`      | BCh | 188 | Cursor right character.                          |
|  `Shift`+`LEFT`  | BDh | 189 | Cursor to end of line.                           |
|  `Ctrl`+`LEFT`   | BEh | 190 | Cursor right word.                               |
|   `Ctrl`+`F1`    | F0h | 240 | Reform paragraph.                                |
|   `Ctrl`+`F2`    | F1h | 241 | Centre line.                                     |
|   `Ctrl`+`F3`    | F2h | 242 | Toggle tab.                                      |
|   `Ctrl`+`F4`    | F3h | 243 | Set left margin.                                 |
|   `Ctrl`+`F5`    | F4h | 244 | Release margins.                                 |
|   `Ctrl`+`F6`    | F5h | 245 | Move paragraph up.                               |
|   `Ctrl`+`F7`    | F6h | 246 | Change line colour.                              |
|    `Alt`+`F1`    | F8h | 248 | Justify paragraph.                               |
|    `Alt`+`F2`    | F9h | 249 | Remove all tab stops.                            |
|    `Alt`+`F3`    | FAh | 250 | Toggle ruler line display.                       |
|    `Alt`+`F4`    | FBh | 251 | Set right margin.                                |
|    `Alt`+`F5`    | FCh | 252 | Reset margins and tabs.                          |
|    `Alt`+`F6`    | FDh | 253 | Move paragraph down.                             |
|    `Alt`+`F7`    | FEh | 254 | Change paragraph colour.                         |

## Для графічних відеосторінок

| Символ  |   HEX    |   DEC   | Опис                                                                         | Опис                                      |
|:-------:|:--------:|:-------:| ---------------------------------------------------------------------------- | ----------------------------------------- |
| `esc A` | 1Bh, 41h | 27, 65  | Встановити промінь на координати                                             | [детальніше](esc-seq/1b41-video-graph.md) |
| `esc R` | 1Bh, 52h | 27, 82  | Перемістити промінь                                                          | [детальніше](esc-seq/1b52-video-graph.md) |
| `esc @` | 1Bh, 40h | 27, 64  | Отримати поточні координати променю                                          | [детальніше](esc-seq/1b40-video-graph.md) |
| `esc S` | 1Bh, 53h | 27, 83  | Увімкнути промінь                                                            | [детальніше](esc-seq/1b53-video-graph.md) |
| `esc s` | 1Bh, 73h | 27, 115 | Вимкнути промінь                                                             | [детальніше](esc-seq/1b73-video-graph.md) |
| `esc .` | 1Bh, 2Eh | 27, 46  | Змінити Line style                                                           | [детальніше](esc-seq/1b2e-video-graph.md) |
| `esc M` | 1Bh, 4Dh | 27, 77  | Змінити Line mode                                                            | [детальніше](esc-seq/1b4d-video-graph.md) |
| `esc a` | 1Bh, 61h | 27, 97  | Змінити тип малювання у атрибутному режимі                                   | [детальніше](esc-seq/1b61-video-graph.md) |
| `esc F` | 1Bh, 46h | 27, 70  | Заповнити замкнений контур кольором                                          | [детальніше](esc-seq/1b46-video-graph.md) |
| `esc E` | 1Bh, 45h | 27, 69  | Намалювати еліпс                                                             | [детальніше](esc-seq/1b45-video-graph.md) |
| `esc ?` | 1Bh, 3Fh | 27, 63  | Отримати поточні координати курсора <br>*(тільки для атрибутного відеорежиму)* | [детальніше](esc-seq/1b3f-video-text.md)  |

## Для аудіоканалів

| Символ | HEX | DEC | Опис                                                                                                                                                |
|:------:|:---:|:---:| --------------------------------------------------------------------------------------------------------------------------------------------------- |
|  `^Z`  | 5Ah | 90  | Очистити усі звукові черги ([CLEAR SOUND](../../manuals/is-basic-man-en/commands/man_cs-clear.md))                                                                        |
|  `^X`  | 58h | 88  | Очистити усі визначення огинаючих ([CLEAR ENVELOPE](../../manuals/is-basic-man-en/commands/man_cs-clear.md))                                                              |
|  `^G`  | 47h | 71  | Генерує звук [PING](../../manuals/is-basic-man-en/commands/man_cs-ping.md) на тональному каналі 2 <br>*(нічого не робить, якщо тональний канал 2 вже використовується)* |

| Символ  |   HEX    |  DEC   | Опис                             | Опис                                |
|:-------:|:--------:|:------:| -------------------------------- | ----------------------------------- |
| `esc E` | 1Bh, 45h | 27, 69 | Ввід огинаючої                   | [детальніше](esc-seq/1b45-audio.md) |
| `esc S` | 1Bh, 53h | 27, 83 | Генерація звука                  | [детальніше](esc-seq/1b53-audio.md) |
| `esc Z` | 1Bh, 5Ah | 27, 90 | Очистити конкретну звукову чергу | [детальніше](esc-seq/1b5A-audio.md) |

## Для IS-DOS

(взято з [інструкції для IS-DOS](../../manuals/is-dos-man-en/isdos-p3-scr-output.md))

| Символ | HEX | DEC | Опис                                                                                                                                                                                                   |
|:------:|:---:|:---:| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
|  `^G`  | 07h |  7  | (Bell) Звуковий сигнал                                                                                                                                                                                 |
|  `^I`  | 09h |  9  | (Tab) Перезаписує пробілами до наступного восьмого стовпця; переходить на початок наступного рядка; прокручує екран при досягненні нижнього правого кута екрану                                        |
|  `^J`  | 0Ah | 10  | (LF; Line Feed) Переведення рядка; прокручує екран, якщо курсор знаходиться внизу екрана                                                                                                               |
|  `^K`  | 0Bh | 11  | Переміщує курсор у верхній лівий кут екрана                                                                                                                                                            |
|  `^L`  | 0Ch | 12  | Очищує екран і переміщує курсор у верхній лівий кут екрана                                                                                                                                             |
|  `^M`  | 0Dh | 13  | (CR; Carriage Return) Повернення каретки                                                                                                                                                               |
|  `^Y`  | 19h | 25  | Стирає до кінця рядка; курсор не рухається                                                                                                                                                             |
|  `^/`  | 1Ch | 28  | Переміщує курсор праворуч; переходить з кінця рядка на початок наступного рядка; зупиняє його в правому нижньому куті екрана                                                                           |
|  `^]`  | 1Dh | 29  | Переміщує курсор ліворуч; переходить з початку рядка на кінець попереднього рядка; зупиняє його у верхньому лівому куті екрана                                                                         |
|  `^^`  | 1Eh | 30  | Переміщує курсор вгору; зупиняє його у верхньому рядку екрана                                                                                                                                          |
|  `^_`  | 1Fh | 31  | Переміщує курсор вниз; зупиняє його у нижньому рядку екрана                                                                                                                                            |
|        | 7Fh | 127 | (Del) видаляє символ під курсором і переміщує текст, що йде після нього, на один символ ліворуч; переходить з початку рядка в кінець попереднього рядка; зупиняє курсор у верхньому лівому куті екрана |

| Символ  |   HEX    |  DEC   | Опис                                                          |
|:-------:|:--------:|:------:| ------------------------------------------------------------- |
| `esc A` | 1Bh, 41h | 27, 65 | Переміщує курсор вгору; зупиняє його у верхньому рядку екрана |
| `esc B` | 1Bh, 42h | 27, 66 | Переміщує курсор вниз; зупиняє його у нижньому рядку екрана |
| `esc C` | 1Bh, 43h | 27, 67 | Переміщує курсор праворуч; зупиняє його у кінці рядку |
| `esc D` | 1Bh, 44h | 27, 68 | Переміщує курсор ліворуч; зупиняє його на початку рядку |
| `esc d <n> <m>` | 1Bh, 64h, \<n\>, \<m\> | 27, 100, \<n\>, \<m\> | Scroll down Lines **n** to **m** inclusive, leaving new Line **n** blank. Lines are numbered starting with top Line as **20h**. |
| `esc E` | 1Bh, 45h | 27, 69 | Очищує екран і переміщує курсор у верхній лівий кут екрана |
| `esc H` | 1Bh, 48h | 27, 72 | Переміщує курсор у верхній лівий кут екрана |
| `esc I` | 1Bh, 49h | 27, 73 | Переміщує курсор вгору; прокручує екран при досягненні верхнього рядку |
| `esc i <n>` | 1Bh, 69h, \<n\> | 27, 105, \<n\> | Вибір кольору тексту:<br> n=**00h**: зелений на чорному<br> n=**02h**: червоний на чорному<br> n=**04h**: синій на білому (чорний на зеленому у режимі **Fast Video**)<br> n=**06h**: блакитний на фіолетовому (чорний на червоному у режимі **Fast Video**) |
| `esc J` | 1Bh, 4Ah | 27, 74 | Видаляє від курсору до кінця екрану; курсор не рухається |
| `esc j` | 1Bh, 6Ah | 27, 106 | Очищує екран і переміщує курсор у верхній лівий кут екрана |
| `esc K` | 1Bh, 4Bh | 27, 75 | Видаляє від курсору до кінця рядку; курсор не рухається |
| `esc L` | 1Bh, 4Ch | 27, 76 | Вставляє рядок над рядком курсора, прокручує решту екрана вниз і переміщує курсор на початок нового рядка |
| `esc l` | 1Bh, 6Ch | 27, 108 | Очищує поточний рядок; курсор не рухається |
| `esc M` | 1Bh, 4Dh | 27, 77 | Видаляє поточний рядок, прокручує решту екрана догори і встановлює курсор на початок наступного рядка |
| `esc x 4` | 1Bh, 78h, 34h | 27, 120, 52 | Вибрати прямокутний курсор ( **█** ) |
| `esc x 5` | 1Bh, 78h, 35h | 27, 120, 53 | Приховати курсор |
| `esc Y <n> <m>` | 1Bh, 59h, \<n\>, \<m\> | 27, 89, \<n\>, \<m\> | Перемістити курсор на рядок **n** і стовпець **m** (верхній лівий кут екрану: **n**=**m**=**20h**) |
| `esc y 4` | 1Bh, 79h, 34h | 27, 121, 52 | Вибрати курсор у вигляді підкреслення ( **\_** ) |
| `esc y 5` | 1Bh, 79h, 35h | 27, 121, 53 | Відобразити курсор |

# Читання даних з відеосторінок

За допомогою команди Бейсіку [GET](../../manuals/is-basic-man-en/commands/man_cs-get.md) можна зчитувати дані з відеоканалів.

Коли символ зчитується з відеосторінки, результат залежить від відеорежиму. З *текстових* буде повернуто ASCII-код символу у позиції курсора без переміщення курсора. З *графічних* буде повернуто колір палітри пікселя у поточній позиції променя. Це буде **0** або **1** у *двоколірному режимі*, **0**—**3** у *чотириколірному режимі*, **0**—**15** у *шістнадцятиколірному* чи *атрибутному режимах* та **0**—**255** у *256-колірному режимі*.


When a character is read from the video driver the result depends on the mode. In text modes the ASCII code of the character at the cursor position will be returned, without moving the cursor. In graphics mode the palette colour of the pixel at the current beam position will be returned. This will be **0** or **1** in *two colour mode*, **0**—**3** in *four colour mode*, **0**—**15** in *sixteen colour* or *attribute modes* and **0**—**255** in *256 colour mode*.

# Приклади

Музичне демо [EnterTunes](https://youtu.be/rJ-msxpS6j4) використовує esc-послідовності для завантаження шрифтів, відмальовки головного екрану (файл **menu.fdr**), та зберігання музичних даних (файли **music1**-**4**)