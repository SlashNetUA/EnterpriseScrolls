# Header Chunk Format

| Name            | Length     | Byte offset | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| --------------- | ---------- |:-----------:| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| DUMMY           | 1 byte     |      0      | `00` always                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| BEGIN_BLOCK     | 1 byte     |   1 / 01h   | `6A` always                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| BLOCK_COUNT     | 1 byte     |   2 / 02h   | `FF` always. This block count is used to recognise that it is a header chunk                                                                                                                                                                                                                                                                                                                                                                                       |
| BYTE_COUNT      | 1 byte     |   3 / 03h   | Length in bytes of header_block=(protection_byte+file_name_length+filename)                                                                                                                                                                                                                                                                                                                                                                                        |
| PROTECTION_BYTE | 1 byte     |   4 / 04h   | Protection byte[^1]:<br>- `00` : protected file<br>- `FF` : unprotected file                                                                                                                                                                                                                                                                                                                                                                                           |
| FILENAME_LENGTH | 1 byte     |   5 / 05h   | Possible values: **0**-**28**                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| FILENAME        | 0-28 bytes |   6 / 06h   | Filename                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| CRC             | 2 bytes    |             | Each data block ends with a 16 bit CRC check. This calculated by treating all bytes of the data block (not including the byte­count byte) as a bit stream. A 16 bit CRC register is initialised to zero at the start of the block and the following process carried out on each bit:<br>1. XOR the new bit into bit 15 of the CRC register<br>2. If the new bit 15 is set then XOR the CRC with 0810h<br>3. Rotate the CRC one bit left, putting bit 15 into bit 0 |
|                 |            |             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |

[^1]: A zero value for this flag inhibits the operation of BASIC's COPY function, thereby allowing a measure of data security for cassette files.

# Internal Chunk Format

| Name        | Length      | Byte offset | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| ----------- | ----------- |:-----------:| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| DUMMY       | 1 byte      |      0      | `00` always                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| BEGIN_BLOCK | 1 byte      |   1 / 01h   | `6A` always                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| BLOCK_COUNT | 1 byte      |   2 / 02h   | Defines how many blocks there are in the chunk. Possible values: **0**-**16**                                                                                                                                                                                                                                                                                                                                                                                      |
|             |             |             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| BYTE_COUNT  | 1 byte      |             | Each block is always **256** bytes long, except for the last block in the last chunk of the file. A block containg **256** bytes of data has a byte count of **zero**, which cannot be misinterpreted because zero is not a valid quantity.                                                                                                                                                                                                                        |
| DATA        | 1-256 bytes |             | Data                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| CRC         | 2 bytes     |             | Each data block ends with a 16 bit CRC check. This calculated by treating all bytes of the data block (not including the byte­count byte) as a bit stream. A 16 bit CRC register is initialised to zero at the start of the block and the following process carried out on each bit:<br>1. XOR the new bit into bit 15 of the CRC register<br>2. If the new bit 15 is set then XOR the CRC with 0810h<br>3. Rotate the CRC one bit left, putting bit 15 into bit 0 |
|             |             |             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |


```
┌─────────────┬───────┬───────┬-- - --┬───────┐
│ Block Count │ BLOCK │ BLOCK │       │ BLOCK │
└─────────────┴───────┴───────┴-- - --┴───────┘
   __________/         \____________________
  /                                         \
 ┌────────────┬─-- - --─┬─────────┬──────────┐
 │ Byte Count │   Data  │ Low CRC │ High CRC │
 └────────────┴─-- - --─┴─────────┴──────────┘
```

Detail information look at [EXOS 2.1 Cassette Driver Specification](http://ep.homeserver.hu/Dokumentacio/Konyvek/EXOS_2.1_technikal_information/exos/cassette/Ch6.html)