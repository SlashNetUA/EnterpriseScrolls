# Enterprise MIDI file

MIDI file converted for playing by Enterprise.  
Extension: **EPM**

## Header (16 bytes)

| Name                  | Length  | Byte offset | Description                                                                                                                                                                                                                                                                                                                                         |
| --------------------- | ------- |:-----------:| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| EXOS header           | 2 bytes |      0      | `00h 6Dh`                                                                                                                                                                                                                                                                                                                                           |
| File size             | 2 bytes |      2      | file size without the header (LSB first), in the case of future compressed formats, this would be the total size of the compressed data                                                                                                                                                                                                             |
| Uncomp. envelope size | 2 bytes |      4      | uncompressed envelope data size                                                                                                                                                                                                                                                                                                                     |
| Uncomp. MIDI size     | 2 bytes |      6      | uncompressed MIDI data size                                                                                                                                                                                                                                                                                                                         |
| Reserved              | 1 byte  |      8      | reserved for future versions, currently always `00h`                                                                                                                                                                                                                                                                                                |
| Compression type      | 1 byte  |      9      | **0**: no compression <br>**2**: is epcompress -m2 <br>others are currently not supported by the player<br>Compressed files can only be played with midi_asm.com or mididisp.com, the C version of the player (midiplay.com) does not implement this feature yet. To unpack a compressed MIDI file, use midipack, which is a modified version of epcompress |
| Comp. envelope size   | 2 bytes |     10      | compressed envelope data size, or 0 if the file is uncompressed                                                                                                                                                                                                                                                                                     |
| Reserved              | 4 bytes |     12      | reserved for future versions, currently always `00h`                                                                                                                                                                                                                                                                                                |

Envelope data (envelope.bin) in the above described format, midiconv automatically removes any unused envelopes MIDI data, the format is similar to standard MIDI files (SMF), but it contains only channel messages on a single track without header, and the delta time between events has a fixed resolution of 1/IRQFREQ seconds. 

For example, the following sequence of bytes plays the 440 Hz „A” note on the first MIDI channel for one second, using instrument 11: 00 C0 0B 00 90 45 7F 32 45 00 When using the -raw parameter, the program converts to a simple headerless format that includes only the raw MIDI data. In this case, it is not necessary to specify a path to an envelope file on the command line.

[source](http://enterprise.iko.hu/magazines/Enterpress_2017_per_4_UK.pdf#page=5)